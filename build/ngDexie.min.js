/**
 * Angularjs wrapper around Dexie.js an IndexedDB handler
 * @version v0.0.9 - build 2015-01-30
 * @link https://github.com/FlussoBV/NgDexie
 * @license Apache License, http://www.apache.org/licenses/
 */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ngDexie"),function(){"use strict";function a(){function a(){return c}var b=this,c={name:"",debug:!1},d=function(){console.error("NgDexie :: No configuration hook has been set!")};b.setOptions=function(a){c=angular.extend({},c,a)},b.setConfiguration=function(a){d=a},b.$get=["$rootScope","$q","$log","ngDexieUtils",function(c,e,f,g){function h(a,b){var c=e.defer();return o.table(a).get(b,function(a){c.resolve(a)}),c.promise}function i(a,b,c){var d=e.defer();return o.table(a).where(b).equals(c).toArray(function(a){angular.isArray(a)&&a.length>0?d.resolve(a[0]):d.reject()}),d.promise}function j(a,d){return angular.isUndefined(a)?o:(angular.isUndefined(d)&&(d=!1),d?c.$apply(function(){a.call(b,o)}):a.call(b,o),o)}function k(a){var b=e.defer();return o.table(a).toArray(function(a){b.resolve(a)}),b.promise}function l(a,b,c){var d=e.defer();return o.table(a).where(b).equals(c).toArray(function(a){d.resolve(a)}),d.promise}function m(a,b){var c=e.defer();return o.table(a).put(g.deepClone(b)).then(function(a){c.resolve(a)}),c.promise}f.debug("NgDexie :: init");var n=a(),o=new Dexie(n.name);return n.debug&&f.warn("NgDexie :: debug mode enabled"),n.debug&&o["delete"]().then(function(){f.warn("debug mode :: Database deleted")}),d.call(this,o),o.open(),o.on("blocked",function(){f.warn("database seems to be blocked")}),{getOptions:a,get:h,getByIndex:i,getDb:j,list:k,listByIndex:l,put:m}}]}angular.module("ngdexie",["ngdexie.core"]),angular.module("ngdexie.core",["ngdexie.utils"]),angular.module("ngdexie.core").provider("ngDexie",a)}(),function(){"use strict";function a(){function a(a){var b=Dexie.deepClone(a);return angular.isDefined(b.$$hashKey)&&delete b.$$hashKey,a}return{deepClone:a}}angular.module("ngdexie.utils",["ngdexie.core"]),angular.module("ngdexie.utils").factory("ngDexieUtils",a)}(),function(){"use strict";function a(a,b,c,d){function e(a,b){var c=d.getDb();angular.isArray(b)||(b=[b]),c.syncable.disconnect(a).then(function(){var d=[];angular.forEach(b,function(a){d.push(c.table(a))}),c.transaction("rw",d,function(){angular.forEach(d,function(a){a.clear()})}).then(function(){return c.syncable["delete"](a).then(function(){setTimeout(function(){c.syncable.connect("iSyncRestProtocol",a)},1500)})})})}function f(a){var b=c.defer(),e=d.getDb();return angular.isDefined(e)&&e.isOpen()&&e.syncable.unsyncedChanges(a).then(function(a){b.resolve(a)}),b.promise}return d.getDb().syncable&&d.getDb().syncable.on("statusChanged",function(a,c){b.$apply(function(){b.$broadcast("ngDexieStatusChanged",{status:a,statusText:Dexie.Syncable.StatusTexts[a],url:c})})}),{resync:e,unsyncedChanges:f}}angular.module("ngdexie.sync",["ngdexie.core"]),angular.module("ngdexie.sync").factory("ngDexieSync",a),a.$inject=["$log","$rootScope","$q","ngDexie"]}();